# åŸºäºåœ°å›¾ä¿¡æ¯å¾®è°ƒçš„AIç¾é£Ÿæ¨èç³»ç»Ÿ

> åŒ—äº¬ç†å·¥å¤§å­¦ NLP è¯¾ç¨‹å¤§ä½œä¸š

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªåŸºäºçœŸå®åœ°ç†ä½ç½®ä¿¡æ¯çš„AIç¾é£Ÿæ¨èç³»ç»Ÿã€‚é€šè¿‡é›†æˆé«˜å¾·åœ°å›¾APIï¼Œä½¿ç”¨Agentæ¡†æ¶è‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡è®­ç»ƒæ•°æ®ï¼Œå¹¶å¯¹Qwen3-0.6Bæ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œå®ç°äº†ä¸ªæ€§åŒ–çš„é¤å…æ¨èåŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹ç‚¹

- ğŸ—ºï¸ **çœŸå®åœ°å›¾æ•°æ®**ï¼šé›†æˆé«˜å¾·åœ°å›¾APIï¼Œè·å–çœŸå®é¤å…ä¿¡æ¯
- ğŸ¤– **æ™ºèƒ½æ•°æ®ç”Ÿæˆ**ï¼šåŸºäºAgentæ¡†æ¶è‡ªåŠ¨åŒ–ç”Ÿæˆè®­ç»ƒæ•°æ®
- ğŸ¯ **ç²¾å‡†æ¨è**ï¼šç»“åˆç”¨æˆ·ä½ç½®ã€é¢„ç®—ã€å£å‘³åå¥½ç­‰å¤šç»´åº¦ä¿¡æ¯
- ğŸ“Š **å®Œæ•´è¯„ä¼°ä½“ç³»**ï¼šä½¿ç”¨LLMå¯¹æ•°æ®è´¨é‡å’Œæ¨¡å‹æ€§èƒ½è¿›è¡ŒåŒç»´åº¦è¯„ä¼°
- ğŸ”§ **ç«¯åˆ°ç«¯æµç¨‹**ï¼šä»æ•°æ®ç”Ÿæˆã€æ¨¡å‹è®­ç»ƒåˆ°æ•ˆæœè¯„ä¼°çš„å®Œæ•´Pipeline

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
.
â”œâ”€â”€ generate_data/          # æ•°æ®ç”Ÿæˆæ¨¡å—
â”‚   â”œâ”€â”€ agent/             # Agentæ™ºèƒ½ä½“
â”‚   â”‚   â””â”€â”€ data_generator_agent.py
â”‚   â”œâ”€â”€ tools/             # å·¥å…·é›†
â”‚   â”‚   â”œâ”€â”€ geo_location_tool.py      # åœ°ç†ä½ç½®æŸ¥è¯¢
â”‚   â”‚   â”œâ”€â”€ restaurant_search_tool.py # é¤å…æœç´¢
â”‚   â”‚   â””â”€â”€ preference_gen_tool.py    # åå¥½ç”Ÿæˆ
â”‚   â”œâ”€â”€ main.py            # æ•°æ®ç”Ÿæˆä¸»ç¨‹åº
â”‚   â”œâ”€â”€ transfer_data.py   # æ•°æ®æ ¼å¼è½¬æ¢
â”‚   â”œâ”€â”€ data_raw.json      # åŸå§‹ç”Ÿæˆæ•°æ®
â”‚   â””â”€â”€ data.json          # æ ¼å¼åŒ–åçš„æ•°æ®
â”œâ”€â”€ fine_tune/             # æ¨¡å‹å¾®è°ƒæ¨¡å—
â”‚   â”œâ”€â”€ prepare_data.py    # æ•°æ®é¢„å¤„ç†
â”‚   â”œâ”€â”€ spilit_train_test.py # æ•°æ®é›†åˆ’åˆ†
â”‚   â”œâ”€â”€ train.py           # æ¨¡å‹è®­ç»ƒ
â”‚   â””â”€â”€ prediction_result.json # æ¨¡å‹é¢„æµ‹ç»“æœ
â”œâ”€â”€ evaluate/              # è¯„ä¼°æ¨¡å—
â”‚   â”œâ”€â”€ evaluate_bailian.py # åŸºäºé˜¿é‡Œäº‘ç™¾ç‚¼çš„è¯„ä¼°
â”‚   â”œâ”€â”€ visualization.py    # å¯è§†åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ prediction_evaluate_visualization.py # é¢„æµ‹ç»“æœå¯è§†åŒ–
â”‚   â”œâ”€â”€ evaluation_results.json    # è¯¦ç»†è¯„ä¼°ç»“æœ
â”‚   â”œâ”€â”€ evaluation_analysis.json   # ç»Ÿè®¡åˆ†æ
â”‚   â””â”€â”€ evaluation_report.txt      # è¯„ä¼°æŠ¥å‘Š
â””â”€â”€ README.md
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- PyTorch 2.0+
- CUDA 11.8+ (GPUè®­ç»ƒ)

### å®‰è£…ä¾èµ–

```bash
pip install torch transformers datasets modelscope
pip install smolagents requests pandas wandb
pip install matplotlib numpy openai
```

### é…ç½®APIå¯†é’¥

1. **é«˜å¾·åœ°å›¾API**ï¼šåœ¨ [`tools/geo_location_tool.py`](generate_data/tools/geo_location_tool.py) å’Œ [`tools/restaurant_search_tool.py`](generate_data/tools/restaurant_search_tool.py) ä¸­é…ç½®
2. **é˜¿é‡Œäº‘ç™¾ç‚¼API**ï¼šåœ¨ [`data_generator_agent.py`](generate_data/agent/data_generator_agent.py) å’Œ [`evaluate_bailian.py`](evaluate/evaluate_bailian.py) ä¸­é…ç½®

## ğŸ“Š ä½¿ç”¨æµç¨‹

### 1ï¸âƒ£ æ•°æ®ç”Ÿæˆ

ä½¿ç”¨Agentæ¡†æ¶è‡ªåŠ¨ç”Ÿæˆè®­ç»ƒæ•°æ®ï¼š

```bash
cd generate_data
python main.py
```

**å·¥ä½œæµç¨‹ï¼š**
1. [`GeoLocationTool`](generate_data/tools/geo_location_tool.py) - æ ¹æ®åœ°åæŸ¥è¯¢ç»çº¬åº¦
2. [`RestaurantSearchTool`](generate_data/tools/restaurant_search_tool.py) - æœç´¢é™„è¿‘é¤å…ï¼ˆåŠå¾„2000ç±³ï¼‰
3. [`PreferenceGenTool`](generate_data/tools/preference_gen_tool.py) - éšæœºç”Ÿæˆç”¨æˆ·åå¥½ï¼ˆèœç³»ã€å£å‘³ã€é¢„ç®—ï¼‰
4. [`DataGeneratorAgent`](generate_data/agent/data_generator_agent.py) - ç»¼åˆåˆ†æç”Ÿæˆæ¨èæ•°æ®

**æ•°æ®æ ¼å¼ç¤ºä¾‹ï¼š**
```json
{
  "Instruction": "æ ¹æ®ç”¨æˆ·ä½ç½®å’Œåå¥½ï¼Œæ¨èç¬¦åˆè¦æ±‚çš„é¤å…",
  "Question": "æˆ‘åœ¨åŒ—äº¬è‰¯ä¹¡åŒ—äº¬ç†å·¥å¤§å­¦ï¼Œä»·æ ¼éœ€æ±‚åŒºé—´ä¸º50-100ï¼Œåå¥½å·èœã€å¥åº·é¥®é£Ÿ",
  "Answer": "ä¸ºæ‚¨æ¨èä»¥ä¸‹é¤å…ï¼š1. å·é¦™æºï¼ˆå·èœï¼‰..."
}
```

### 2ï¸âƒ£ æ•°æ®é¢„å¤„ç†

```bash
cd fine_tune
# è½¬æ¢æ•°æ®æ ¼å¼
python transfer_data.py

# åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼ˆ8:1ï¼‰
python spilit_train_test.py

# æ ¼å¼åŒ–ä¸ºè®­ç»ƒæ ¼å¼
python prepare_data.py
```

[`prepare_data.py`](fine_tune/prepare_data.py) ä¼šå°†æ•°æ®è½¬æ¢ä¸ºæ¨¡å‹è®­ç»ƒæ‰€éœ€çš„æ ¼å¼ã€‚

### 3ï¸âƒ£ æ¨¡å‹å¾®è°ƒ

```bash
python train.py
```

**è®­ç»ƒé…ç½®ï¼š**
- åŸºç¡€æ¨¡å‹ï¼šQwen3-0.6B
- è®­ç»ƒè½®æ¬¡ï¼š8 epochs
- å­¦ä¹ ç‡ï¼š1e-4
- Batch Sizeï¼š1ï¼ˆæ¢¯åº¦ç´¯ç§¯4æ­¥ï¼‰
- æœ€å¤§é•¿åº¦ï¼š2048 tokens

è®­ç»ƒè¿‡ç¨‹é€šè¿‡Weights & Biaseså¯è§†åŒ–è·Ÿè¸ªã€‚è¯¦è§ [`train.py`](fine_tune/train.py)ã€‚

### 4ï¸âƒ£ æ¨¡å‹è¯„ä¼°

ä½¿ç”¨LLMå¯¹æ•°æ®è´¨é‡å’Œæ¨¡å‹æ€§èƒ½è¿›è¡Œè¯„ä¼°ï¼š

```bash
cd evaluate
python evaluate_bailian.py
```

**è¯„ä¼°ç»´åº¦ï¼š**

1. **è®­ç»ƒæ•°æ®è´¨é‡ï¼ˆ10åˆ†åˆ¶ï¼‰**
   - å‡†ç¡®æ€§ï¼ˆ2åˆ†ï¼‰ï¼šé¤å…ä¿¡æ¯çœŸå®æ€§
   - ä¸€è‡´æ€§ï¼ˆ2åˆ†ï¼‰ï¼šé€»è¾‘ä¸€è‡´æ€§
   - å¤šæ ·æ€§ï¼ˆ2åˆ†ï¼‰ï¼šè¦†ç›–å¤šç§åœºæ™¯
   - æ ¼å¼è§„èŒƒæ€§ï¼ˆ2åˆ†ï¼‰ï¼šç»“æ„å®Œæ•´æ€§
   - å®ç”¨æ€§ï¼ˆ2åˆ†ï¼‰ï¼šæ¨èåˆç†æ€§

2. **åŸå§‹æ¨¡å‹è¡¨ç°ï¼ˆ10åˆ†åˆ¶ï¼‰**
   - ç†è§£èƒ½åŠ›ï¼ˆ2åˆ†ï¼‰ï¼šç†è§£ç”¨æˆ·éœ€æ±‚
   - æ¨èåˆç†æ€§ï¼ˆ2åˆ†ï¼‰ï¼šç¬¦åˆæ‰€æœ‰æ¡ä»¶
   - ä¿¡æ¯å®Œæ•´æ€§ï¼ˆ2åˆ†ï¼‰ï¼šæä¾›å…³é”®ä¿¡æ¯
   - é€»è¾‘æ¸…æ™°æ€§ï¼ˆ2åˆ†ï¼‰ï¼šç»“æ„æ¸…æ™°
   - å¤šæ ·æ€§ï¼ˆ2åˆ†ï¼‰ï¼šé¿å…é‡å¤æ¨è

è¯¦è§ [`evaluate_bailian.py`](evaluate/evaluate_bailian.py) ä¸­çš„ [`RestaurantDataEvaluator`](evaluate/evaluate_bailian.py) ç±»ã€‚

### 5ï¸âƒ£ ç»“æœå¯è§†åŒ–

```bash
# åŸºç¡€å¯è§†åŒ–
python visualization.py

# é¢„æµ‹ç»“æœå¯è§†åŒ–
python prediction_evaluate_visualization.py
```

ç”ŸæˆåŒ…å«è¯„åˆ†åˆ†å¸ƒã€å¯¹æ¯”é›·è¾¾å›¾ã€å…³é”®æŒ‡æ ‡ç­‰çš„å¯è§†åŒ–æŠ¥å‘Šã€‚

## ğŸ“ˆ å®éªŒç»“æœ

### æ•°æ®é›†ç»Ÿè®¡

- **æ ·æœ¬æ€»æ•°**ï¼š1090ä¸ª
- **è®­ç»ƒé›†**ï¼š872ä¸ªï¼ˆ80%ï¼‰
- **éªŒè¯é›†**ï¼š218ä¸ªï¼ˆ20%ï¼‰

### è¯„ä¼°ç»“æœ

| æŒ‡æ ‡ | è®­ç»ƒæ•°æ®è´¨é‡ | æ¨¡å‹è¡¨ç° |
|------|------------|---------|
| å¹³å‡åˆ† | **7.55** | **6.64** |
| æœ€é«˜åˆ† | 9 | 9 |
| æœ€ä½åˆ† | 2 | 1 |
| ä¸»è¦åˆ†å¸ƒ | 8åˆ†(48.6%) | 7åˆ†(45.6%) |

### å…³é”®å‘ç°

1. **é«˜è´¨é‡æ•°æ®é›†**ï¼šè®­ç»ƒæ•°æ®è´¨é‡å¹³å‡7.55åˆ†ï¼Œ8-9åˆ†å æ¯”67%
2. **ç¨³å®šæ¨¡å‹è¡¨ç°**ï¼šæ¨¡å‹è¡¨ç°å¹³å‡6.64åˆ†ï¼Œ7-8åˆ†å æ¯”63.4%
3. **å¼ºç›¸å…³æ€§**ï¼šæ•°æ®è´¨é‡ä¸æ¨¡å‹è¡¨ç°ç›¸å…³æ€§ç³»æ•°**0.956**ï¼Œè¯æ˜é«˜è´¨é‡æ•°æ®ç›´æ¥æå‡æ¨¡å‹æ€§èƒ½

è¯¦ç»†åˆ†æè§ [evaluation_report.txt](evaluate/evaluation_report.txt)ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **æ•°æ®ç”Ÿæˆ**ï¼šsmolagents, LiteLLM, é«˜å¾·åœ°å›¾API
- **æ¨¡å‹è®­ç»ƒ**ï¼štransformers, PyTorch, ModelScope
- **è¯„ä¼°ç³»ç»Ÿ**ï¼šé˜¿é‡Œäº‘ç™¾ç‚¼API, OpenAI SDK
- **å¯è§†åŒ–**ï¼šmatplotlib, numpy
- **å®éªŒç®¡ç†**ï¼šWeights & Biases

## ğŸ“ æ ¸å¿ƒä»£ç è¯´æ˜

### Agentæ•°æ®ç”Ÿæˆ

[`DataGeneratorAgent`](generate_data/agent/data_generator_agent.py) ç»§æ‰¿è‡ª `ToolCallingAgent`ï¼Œé€šè¿‡å·¥å…·è°ƒç”¨å®ç°ï¼š
1. åœ°ç†ä½ç½®æŸ¥è¯¢
2. é¤å…ä¿¡æ¯æœç´¢
3. ç”¨æˆ·åå¥½ç”Ÿæˆ
4. ç»¼åˆåˆ†æä¸æ¨è

### æ•°æ®é¢„å¤„ç†

[`process_func`](fine_tune/train.py) å‡½æ•°å®ç°ï¼š
- æ„å»ºå®Œæ•´çš„promptæ¨¡æ¿
- è®¾ç½®labelsï¼ˆinstructionéƒ¨åˆ†maskä¸º-100ï¼‰
- æˆªæ–­è‡³æœ€å¤§é•¿åº¦

### è¯„ä¼°ç³»ç»Ÿ

[`RestaurantDataEvaluator`](evaluate/evaluate_bailian.py) å®ç°ï¼š
- æ‰¹é‡è¯„ä¼°ï¼ˆè‡ªåŠ¨æ§åˆ¶è¯·æ±‚é¢‘ç‡ï¼‰
- åŒç»´åº¦æ‰“åˆ†ï¼ˆæ•°æ®è´¨é‡+æ¨¡å‹è¡¨ç°ï¼‰
- ç»Ÿè®¡åˆ†æï¼ˆè¯„åˆ†åˆ†å¸ƒã€ç›¸å…³æ€§è®¡ç®—ï¼‰
- æŠ¥å‘Šç”Ÿæˆ

## ğŸ¤ è´¡çŒ®è€…

åŒ—äº¬ç†å·¥å¤§å­¦ NLP è¯¾ç¨‹å¤§ä½œä¸šé¡¹ç›®

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ç”¨äºå­¦æœ¯ç ”ç©¶å’Œå­¦ä¹ ç›®çš„ã€‚

## ğŸ”— ç›¸å…³é“¾æ¥

- [Qwen3æ¨¡å‹](https://github.com/QwenLM/Qwen)
- [smolagentsæ¡†æ¶](https://github.com/huggingface/smolagents)
- [é«˜å¾·åœ°å›¾API](https://lbs.amap.com/)
- [é˜¿é‡Œäº‘ç™¾ç‚¼å¹³å°](https://www.aliyun.com/product/bailian)

---

**æ³¨æ„äº‹é¡¹**ï¼š
- ä½¿ç”¨å‰è¯·ç¡®ä¿å·²é…ç½®æ‰€æœ‰å¿…éœ€çš„APIå¯†é’¥
- è®­ç»ƒéœ€è¦GPUæ”¯æŒï¼Œå»ºè®®è‡³å°‘16GBæ˜¾å­˜
- è¯„ä¼°è¿‡ç¨‹ä¼šè°ƒç”¨å¤§é‡APIï¼Œæ³¨æ„æ§åˆ¶è¯·æ±‚é¢‘ç‡å’Œæˆæœ¬
